<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>But That's Just My Opinion.  I Could Be Wrong.</title>
<link rel="stylesheet" type="text/css" href="virus_files/rants.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<div id="content">

<p><em>The most recent version of these essays can be found at <a href="http://linuxmafia.com/%7Erick/faq/">http://linuxmafia.com/~rick/faq/</a>.</em></p>

              <h1><a name="top">Rick's Rants</a></h1>

              <p align="center">("That's what
              you get for swimming in the shallow end of the gene
              pool.")</p>

<center><a href="http://linuxmafia.com/%7Erick/faq/">-Modems-</a>&nbsp;&nbsp;&nbsp;<a href="http://linuxmafia.com/%7Erick/faq/index.php?page=hardware">-Hardware-</a>&nbsp;&nbsp;&nbsp;<a href="http://linuxmafia.com/%7Erick/faq/index.php?page=kicking">-Linux&nbsp;Tire-Kicking-</a>&nbsp;&nbsp;&nbsp; <em><strong><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=virus">-Virus-</a></strong></em>&nbsp;&nbsp;&nbsp; <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=warez">-Proprietary&nbsp;Warez-</a>&nbsp;&nbsp;&nbsp; <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=maclinux">-MacLinux-</a>&nbsp;&nbsp;&nbsp; <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=crybaby">-Crybaby-</a>&nbsp;&nbsp;&nbsp; <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=netiquette">-Netiquette-</a>&nbsp;&nbsp;&nbsp; <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=misc">-Miscellany-</a>&nbsp;&nbsp;&nbsp; </center>

<br>
              <p><em>Economy of expression</em> is a good thing.
              So, rather than have to repeat myself continually,
              I'm posting my top rants here, for ready reference.
              Many of you (readers) will be visiting today because
              I pointedly referred you to the "#"-tagged URL of
              some particular item, below.</p>
<br>
<br>
<div id="topcontent">
<h2>Table o' Contents</h2>
<ul>
<li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=modems">Modems</a> . . .</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=hardware">Hardware</a> . . .</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=kicking">Linux Tire-Kicking</a> . . .</li><li><h3>Virus . . .</h3>

<ul>
<li><strong>Should I get <a href="#virus" name="
virus-q">anti-virus software</a> for my Linux
box?</strong></li>

<li><strong>But didn't security expert <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=virus#virus2" name="virus2-q">Simson Garfinkel</a> say
that all Linux systems need virus
checkers?</strong></li>

<li><strong>Don't the rise of <a href="#virus3" name="virus3-q">Linux worms</a> show that Linux now
has a virus problem?</strong></li>

<li><strong>Isn't Microsoft Corporation's <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=virus#virus4" name="virus4-q">market dominance</a>,
making Linux an insignificant target, the only
reason it doesn't have a virus
problem?</strong></li>

<li><strong>But how can you say there's no virus problem, 
when there have been 
<a href="#virus5" name="virus5-q">several dozen Linux viruses</a>?
</strong></li>
</ul>
<br>
</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=warez">Proprietary Warez</a> . . .</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=maclinux">MacLinux</a> . . .</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=crybaby">Crybaby</a> . . .</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=netiquette">Netiquette</a> . . .</li><li><a href="http://linuxmafia.com/%7Erick/faq/index.php?page=misc">Miscellany</a> . . .</li></ul>
</div>
<h3>Virus Department</h3> 
            <ul>
                <li><p><a name="virus"></a><strong>Should I get 
                anti-virus software for my Linux box?</strong></p>

                <p>The problem with answering this question is that
                those asking it know <em>only</em> OSes where
                viruses, trojan-horse programs, worms, nasty
                Javascripts, ActiveX controls with destructive
                payloads, and ordinary misbehaved applications are
                a constant threat to their computing. Therefore,
                they <em>refuse to believe</em> Linux could be
                different, no matter what they hear.</p>

                <p>And yet it is.</p>

                <p>Here's the short version of the answer: No. If you
                simply <em>never run untrusted executables while
                logged in as the root user (or equivalent)</em>,
                all the "virus checkers" in the world will be at
                best superfluous; at worst, downright harmful.
                "Hostile" executables (including viruses) are
                <em>almost unfindable</em> in the Linux world —
                and no real threat to it — because they lack
                root-user authority, and because Linux admins are
                seldom stupid enough to run untrusted executables
                as root, <em>and</em> because Linux users' sources
                for privileged executables enjoy paranoid-grade
                scrutiny (such that any unauthorised changes would
                be detected and remedied).</p>

                <p>Here's the long version: <em>Still</em> no. Any
                program on a Linux box, viruses included, can only
                do what the user who ran it can do. Real users
                aren't allowed to hurt the system (only the root
                user can), so neither can programs they run.</p>

                <p>Because of the distinction between privileged
                (root-run) processes and user-owned processes, a
                "hostile" executable that a non-root user receives
                (or creates) and then executes (runs) cannot
                "infect" or otherwise manipulate the system as a
                whole. Just as you can delete only your own files
                (i.e., those you have "write" permission to),
                executables you run cannot affect other users' (or
                root's) files. Therefore, although you can create
                (or retrieve), and then run, a virus, worm, trojan
                horse, etc., <em>it can't do much</em>. Unless you
                do so as "root". Which it's simple to avoid
                doing.</p>

                <p>The first "virus" (arguably, actually a trojan or
                worm) for Linux was named "<a href="http://math-www.uni-paderborn.de/%7Eaxel/bliss/">Bliss</a>",
                created in September 1996 as a proof of concept. If a user
                executes an infected executable, the viral code
                appends itself to all executables for which the
                user has write permission. But thereafter, it can't
                go anywhere else or do anything else — and cannot
                take over (infect) the local machine (or any
                other): It lacks permission to do so. Nor can the
                <a href="http://web.archive.org/web/20020802052642/http://www.big.net.au/%7Esilvio/">other
                Linux/Unix viruses</a> / <a href="http://web.archive.org/web/20011025055053/http://www.proza.cc/worm/worm.html">worms</a> /
                <a href="http://www.cert.org/advisories/CA-1999-02.html">trojan
                horses</a> thus far known. And claims of "Bliss"
                infections outside deliberate lab-only deployment
                by virus researchers are, in point of fact,
                <a href="http://web.archive.org/web/20080525102131rn_1/news.zdnet.co.uk/communications/0,1000000085,2065154,00.htm">
                considered suspect</a>. New Linux viruses (such as
                <a href="http://web.archive.org/web/20031002232732/http://www.securityfocus.com/infocus/1671">Simile.D</a>)
                emerge continually, too. But guess what? They don't
                go anywhere, either.</p>

                <p>Most people asking this question have no experience
                with true multi-user systems built around a
                pervasive, ground-up security model. On their
                systems, any process the user executes, directly or
                indirectly, can modify, destroy, or manipulate
                <em>anything</em> on the system. This is true to a
                degree even on MS-Windows NT/XP, which
                <em>tries</em> to be fully multiuser as Unixes are,
                but has numerous fundamental security flaws.</p>

                <p>By contrast, on Linux (or any other Unix), your
                processes <em>cannot</em> harm the machine (or
                damage other users' files) — because you yourself
                cannot.</p>

                <p>Thus, even a Linux user who <em>deliberately
                wants</em> to activate a Linux virus (trojan horse,
                worm, or other program designed to do mischief)
                will have extreme difficulty getting it to
                circulate. If you're a programmer, try and see.
                Viruses aren't difficult to write on Linux: Write
                one, run it (as a non-root user), and watch it
                bollix your files. <em>But nobody else's.</em></p>

                <p>Three objections are commonly raised to the above
                argument:</p>

                <p>1) Ah, you say, all you need do is insert "hostile"
                code into some package that must run with root-user
                privileges. True, that would work: Just infiltrate
                the main software-distribution chains. But this is
                extremely difficult, not just because the
                distribution chain is well monitored by paranoid
                technical people, but also because, with
                open-source code, any odd modifications would be
                quickly found by the large number of programmers
                working on the source code, and removed.</p>

                <p>For example, on January 21, 1999, it was discovered
                that the main distribution site of Wietse Venema's
                key TCP Wrappers package, ftp.win.tue.nl at Eindhoven
                University, had been site-compromised and the 
                development copy of TCP Wrappers there had been 
                <a href="http://www.packetstormsecurity.org/9901-exploits/tcpwrapper-backdoor.txt">trojaned</a>.  
                No Linux distributions were affected because they and other
                wary observers check PGP signatures on "upstream" 
                source releases, and, in fact, the compromise was
                detected within hours by Andrew Brown of Crossbar 
                Security, Inc., because he noticed that tcp_wrappers_7.6.tar.gz 
                was unsigned.  (The next day, util-linux development 
                release 2.9g at that site was also 
                <a href="http://seclists.org/bugtraq/1999/Jan/286">trojaned</a>: 
                exact same outcome.)</p>

                <p>On September 28, 2002, similarly, the public 
                ftp.sendmail.org server was site-compromised and
                trojaned source-code packages of sendmail 8.12.6 were
                offered there — probably not PGP-signed —
                for eight days.  Shortly before that, around July 30,
                2002, the same thing happened with the OpenBSD Foundation's 
                ftp server and hosted packages of OpenSSH 3.2.2p1, 3.4p1, 
                and 3.4 development source code.  This trojaning was 
                caught and corrected in about a day; as in all the other
                cases, source-code downloaders who 
                <em>check package signatures</em> weren't fooled.</p>

                <p>On December 13, 2007, post-release source tarballs of 
                SquirrelMail 1.4.11 and 1.4.12 on www.squirrelmail.org 
                were <a href="http://lwn.net/Articles/262688/">found</a> 
                to have been trojaned by an intruder using a 
                security-compromised developer account to insert a 
                remote-execution backdoor.  This deed was (once again)
                caught by a user noticing that the packages' md5 checksums
                did not check out.  (The inexcusably lax developers only
                started gpg-signing their releases' md5 sums with the 
                following version, 1.4.13.)</p>

                <p>On November 8, 2010, release source tarballs of 
                ProFTPD 1.3.3c on ftp.proftpd.org were 
                <a href="http://www.exploit-db.com/exploits/15662/">found</a>
                to have been replaced by a trojaned version.  ProFTPD 
                maintainer speculated that intruders used an unpatched 
                flaw in ProFTPD itself, which, given the sorry 
                <a href="http://linuxmafia.com/faq/Network_Other/ftp-daemons.html">record</a>
                of that notoriously buggy software is sadly credible.  
                Downloader Daniel Austin 
                <a href="http://www.mail-archive.com/proftp-mirrors@proftpd.org/msg00059.html" noticed<="" a=""> 
                the modification three days later, probably by checking 
                PGP-signatures.</a></p><a href="http://www.mail-archive.com/proftp-mirrors@proftpd.org/msg00059.html" noticed<="" a="">

                </a><p><a href="http://www.mail-archive.com/proftp-mirrors@proftpd.org/msg00059.html" noticed<="" a="">On June 30, 2011, release versions of vsftpd version
                2.3.4 on vsftpd.beasts.org was (somehow -- not yet
                clear) </a><a href="http://lwn.net/Articles/450181/">replaced</a> 
                by a trojaned version containing a remote-login
                backdoor.  As before, the substitution was caught by 
                a user noticing the tarball's md5 and sha1 checksums no 
                longer validate against the developer's signature,
                after the trojaned version had been available for 3
                days.  (The developer immediately moved to new hosting,
                so we may never learn how the trojaning occurred.)</p>

                <p>Around August 12, 2011, Linux kernel server
                hera.kernel.org and several related machines were 
                root-compromised via (probably) stolen user credentials,
                which access was then escalated to root-user access in
                some fashion still being studied at this writing 
                shortly after the compromise was discovered 
                (Aug. 28, 2011, 16 days after break-in). 
                The kernel source tree was not, and could not be, 
                compromised, because it's stored entirely in 
                sha1-cryptographically-vetted 'git' trees.  In theory,
                someone in control of those machines could have replaced
                downloadable kernel tarballs (compressed archives) with
                trojaned versions (this is being checked), but there
                would have been limited point as then they would not 
                match the sha1 signatures of git checkouts, hence
                would soon get caught.  Also, the downloadable tarballs 
                aren't used for development; hence the development code 
                would be unaffected.</p>

                <p>With <em>binary-only</em> Linux software (little of
                which must run with root authority), e.g., packages
                offered by proprietary software companies, you
                would face the equally daunting task of
                adulterating the product of a company that realises
                such intrusions would damage its reputation (unlike
                in the MS-Windows market, where Microsoft
                Corporation has repeatedly shipped virus-infected
                CD-ROMs, and nobody considered that peculiar or
                unacceptable). Given that have you pulled off such
                a feat, your virus would then encounter the
                previously-detailed barriers to its further spread,
                and thus probably go roughly nowhere (beyond the
                systems initially infected). And then, the damaged
                systems would get rebuilt, and the virus would
                effectively die out.</p>

                <p>(Occasional late arrivals to Linux from the proprietary
                world have on rare occasions been found to have built
                secret backdoors into their own official software releases,
                presumably not caring about the loss to their reputation.
                It seems only fair to help them:  On Jan. 9, 2001, 
                security researchers found that Borland/Inprise's SQL
                database "Interbase" included backdoor access on port
                3050/tcp to 
                <a href="https://www.kb.cert.org/vuls/id/247371">undocumented 
                service account</a> "LOCKSMITH" with full access to all 
                database objects.  In Feb. 2003, Rüdiger Kuhlman,
                maintainer of instant messaging program mICQ, now known as 
                "climm", introduced obfuscated code into his own program
                to make it <a href="http://lwn.net/Articles/22991/">refuse
                to run on Debian</a>.  One does wonder how many popular
                proprietary programs on legacy proprietary OSes have 
                similar hidden code.)

                </p><p>2) Well then, you say, one might engineer a virus
                to start out as a user-owned process, but then
                crack the local security model from the inside.
                This approach, too, might work — if it could be
                done <em>unobtrusively</em>. At any given time,
                some of any Linux (or other Unix) system's dozens
                of root-owned system binaries will undoubtedly be
                vulnerable to attack, but viruses and similar code
                must be small, simple, and unobtrusive. The two
                goals are incompatible.</p>

                <p>(The possibility <em>does</em> point out why it's
                important that users understand that they're responsible
                for processes that run under their user authority:
                If some untrustworthy code you've downloaded and 
                decided to run backgrounds itself and performs
                nasty tricks on others and/or hammers away
                at possible system weaknesses until it finds a way to 
                escalate privilege, it's <em>your fault</em>.  So, 
                know the processes listed by "ps uxw", and understand
                why you're running each.)</p>

                <p>But this brings up another reason why Linux/Unix
                systems tend to be hardy: genetic diversity. That
                is, for virus-like code to spread among Linux
                boxes, it must be unfazed by the variety of CPU
                architectures Linux supports, and their diversity
                of software and of configuration. As long as Linux
                distributions remain diverse, they will be that
                much harder a target.</p>

                <p>3) Last, you say, surely sysadmins stupid enough to
                take dangerous actions as root must be becoming
                <em>the norm</em> instead of a rarity, given
                Linux's current explosive growth — thus
                undermining the whole security model. This, too, is
                true — but there are powerful forces at work to
                educate new sysadmins: The administrative tools,
                themselves, tend to stress that the root account is
                dangerous and should be used minimally and
                carefully, as does Linux's new-user documentation.
                Also, those sysadmins resistant to learning this
                message via such avenues inevitably learn it
                <em>the hard way</em>, by destroying or crippling
                their systems repeatedly — until they learn. In
                that regard, viruses do not even stand out from the
                general likelihood of repeatedly destroying one's
                system, until one learns to <em>not do unwise
                things as root</em>. The difference between
                "hostile" executables (such as viruses) and others
                is academic, when a root-account user can
                <em>already</em> shoot off his/her foot or other vital
                parts, with one of myriad, brief commands. Put the
                other way, the same survival skills by which you,
                as a novice sysadmin, will cease destroying your
                system directly will also, more generally, dissuade
                you from <em>doing unwise things as root</em>,
                thereby incidentally keeping viruses and their kin
                off your system.</p>

                <p>Or, put a third way, the Linux community would see
                no real distinction between novices who (as root)
                infect their systems (if this should ever happen to
                significant numbers of them), and those who
                accidentally type some variation on "rm -rf /"
                (delete all files) while logged in as root: Both
                are a result of inexperience and lack of caution.
                In both cases, education, attention, and experience
                are a 100% effective cure.</p>

                <p>The above discussion has centred on the
                <em>root</em> user's actions, and has mostly been
                variations on the theme of <em>don't run untrusted
                executables as root</em>. There remains one other
                option: viruses (and similar things) that <em>don't
                attempt</em> to affect system binaries or take over
                entire machines, but instead dwell in a particular
                user's account and attempt to spread to other user
                accounts, on that or other machines, via inter-user
                communication mechanisms such as e-mail. One might
                imagine, for example, a virus written in "elisp",
                the macro language of GNU emacs and xemacs, and
                propagating as attachments to e-mail sent to other
                emacs users.</p>

                <p>Such an invention would be <em>at worst</em> a
                nuisance among a few users, as it could affect only
                users running the same combinations of user
                software. Further, the Unix community long ago
                became wary of auto-executing programs/macros, so
                ultimately this technique would rely on convincing
                each additional user to <a href="http://linuxtoday.com/news_story.php3?ltsn=2001-09-07-014-20-SC&amp;tbovrmode=1">
                execute (run) the program</a>/macro, to "infect"
                his/her files. Also, in the Linux/Unix world, macros
                tend to be stored as readable plain text (unlike
                the case with, say, MS-Word), so that untrustworthy
                code is difficult to conceal from user
                scrutiny.</p>

                <p>In these areas, again, viruses wouldn't stand out
                from the general category of programs another user
                sends you that you shouldn't run: If a friend
                mailed you a script that would erase all your
                files, would you run it? Of course not. In the
                <em>same</em> sense, you would not automatically
                run any <em>other</em> executable that landed on
                your doorstep, from another user — and Linux
                programs will pretty reliably not auto-run them
                <em>for</em> you (nor even save them with the
                executable bit still present). If Linux programs
                emerge that <em>do</em> auto-execute (e.g.) macros
                in documents attached to e-mail (as does the
                combination of MS-Outlook or MS-Outlook Express
                with MS-Word on Win32 systems), there might be a
                flurry of viruses transmitted that way, until the
                foolishness of such a feature becomes obvious to
                all — or until only fools run such programs.</p>

                <p>Linux systems <em>can</em> be indirectly affected
                by viruses arising on more-vulnerable systems. If
                you offer file-sharing services from a Linux
                machine to others on its network, such as NFS,
                Samba, or NetATalk, the other machines might well
                <em>store</em> infected programs on the shared
                volumes. (For this reason, sometimes Linux
                sysadmins run checkers to catch and remove
                <em>foreign OS</em> viruses from shared files,
                in-transit e-mail, and the like.) Also, the Linux
                boot process might be interrupted by operation of
                (say) a virus originating in MS-Windows, and
                affecting boot-sensitive areas such as the Master
                Boot Record. But these are not Linux viruses, which
                remain vanishingly rare and (effectively) a
                harmless curiosity.</p>

                <p>And yet. . . . And yet, the big anti-viral
                companies such as McAfee and Symantec <em>all</em>
                hawk anti-viral products for Linux. Why would they
                do this, if viruses pose no threat? Because
                gullible people have money, too, that's why. Such
                products are sold to the crowds of people who
                refuse to believe essays like this one. If you feel
                that way, buy them with pride: It's easier than
                thinking.</p>

                <p>But then again, maybe you <a href="http://cm.bell-labs.com/who/ken/trust.html">just can't
                trust anyone</a>. Caveat user.</p>

                <p>For a knowledgeable, but more glass-half-empty,
                view of Unix viruses, see also <a href="http://web.archive.org/web/20080528010228/http://www.securitymap.net/sdm/docs/virus/unix-virus-459.html">Rado
                Dejanovic's article</a>. Also, <a href="http://www.stratigery.com/virefs.html">Bruce
                Ediger</a> appears to be interested in the same
                subject.  Be sure to check out, also, David F. Skoll's
                <a href="http://linuxmafia.com/%7Erick/skoll/anti-virus.php">
                article</a>, especially the hilarious "Challenge" 
                section near the bottom.</p>

                <p>All this is not intended to suggest that
                system-integrity checkers like <a href="http://www.cs.tut.fi/%7Erammer/aide.html">AIDE</a>,
                <a href="http://www.tripwire.org/">Tripwire</a>,
                and other <a href="http://packetstormsecurity.nl/UNIX/IDS/">IDSes</a>
                aren't an excellent idea: Being able to detect
                unauthorised changes is a very good thing. Ditto
                the various schemes to "sandbox" untrusted
                code.</p>

                <p>By the way, the ill-informed <a href="http://slashdot.org/article.pl?sid=00/01/24/1115253">
                lucubrations</a> of a Slashdot writer to the
                contrary, there is no such word as "virii". The
                <a href="http://linuxmafia.com/%7Erick/faq/plural-of-virus.html">plural of this 
                English word is "viruses"</a>. (The word
                was borrowed and redefined from the Latin word
                virus = slime, poison, or venom. In Latin, that is
                a 2nd declension neuter noun, whose nominative
                plural form is now unclear, since it seems that
                nobody ever used one — and it doesn't appear to
                work like either a standard "-us" or "-um" noun,
                whose plural behaviours are known. In other words,
                it doesn't have a Latin plural, possibly because it
                was a mass noun rather than a countable one.)</p>
                </li>

                <li><p><a name="virus2"></a><strong>But didn't 
                security expert Simson L.
                Garfinkel say that all Linux systems needed to run
                virus checkers?</strong></p>

                <p>Yes. Top security authority Garfinkel, co-author of
                <a href="http://oreilly.com/catalog/9780596003234/">Practical
                Unix and Internet Security</a> and other classics,
                <em>did</em> say, in <a href="http://www.simson.net/clips/2000/2000.SecurityFocus.Linux_Viruses.html">
                a SecurityFocus article</a>, that a plague of
                viruses are destined to descend upon Linux, and
                that the only cure is for all Linux systems to run
                "credible anti-virus software".</p>

                <p>Garfinkel acknowledges that the threat he envisions
                exists only because inexperienced sysadmins "are
                incredibly promiscuous with the root account", but
                he thinks running software that compensates for
                root-user carelessness is an appropriate and
                adequate remedy.</p>

                <p>Unfortunately, this world-class authority is dead
                wrong: There is no way that automated "checking"
                software can ever prevent a careless root user from
                damaging (or fully destroying) the system. As
                explained in the prior essay, the remedy is not
                <em>adequate</em> because viruses are a very minor
                system threat compared to the extremely broad
                variety of easy ways a root-account user has of
                damaging/destroying his/her system, and that remedy is
                not <em>appropriate</em> because it fails to
                address the underlying, real problem of
                <em>sysadmins being willing to carry out dangerous
                actions while logged in as the root user</em>.</p>

                <p>It is simply not possible to create and run a piece
                of software sophisticated enough to prevent a root
                user from running scripts, system commands,
                interpreted programs, or any of myriad non-virus
                executables having destructive potential equal to
                or greater than that of any virus. Further, such a
                program would be hostile to the very idea of a root
                account, which is <em>by design</em> supposed to be
                able to carry out any possible action on the
                system.</p>

                <p>(And, by the way, what's going to protect you from
                subverted or just <a href="http://news.com.com/Antivirus+insecurity+at+Black+Hat+confab/2100-7355_3-5805750.html">dangerously defective</a> <em>virus
                checkers</em>, themselves wielding root authority?
                Hmm?  And why on <strong>earth</strong> would we
                entrust our system security to ethically suspect firms who 
                <a href="http://www.wired.com/news/privacy/0,1848,69601,00.html">demonstrably</a> — and please note that both anti-virus and also
                commercial security-monitoring firms (with honourable
                exceptions ClamAV and 
                <a href="http://www.businessweek.com/technology/content/nov2005/tc20051129_938966.htm">F-Secure</a>) were culpable in
                that hyperlinked example of corrupt collusion —
                have a tendency to sell their own customers down the
                river?)</p>

                <p>The implication is clear: If a user lacks the
                judgement to use the root account safely, the only
                way to protect the system from that user is for him/her
                to <em>not have root access</em>. After carrying
                out this remedy to address the <em>real</em> causes
                of the problem, adding a "virus checker" is neither
                necessary nor useful.</p>

                <p>It should be noted that there is nothing wrong with
                lacking the root password to one's system.
                Corporations do that with Unix boxes all the time.
                Somebody <em>else</em>, whom you trust to do any
                rare system administration tasks required, can keep
                and use your root password.</p>

                <p>Is this inconvenient? Possibly. At a minimum, it
                requires modifying the usual PC-desktop habits of
                thinking — e.g., you might have to provide
                security-hardened remote access to your Linux box
                using <a href="http://linuxmafia.com/ssh/">
                ssh/scp</a>. But that is a good thing, because it
                allows you to deal with real, fundamental problems
                in an effective manner. Adopting Garfinkel's
                would-be solution does not accomplish that.</p>
                </li>

                <li><p><a name="virus3"></a><strong>Don't the rise 
                of Linux worms like
                Ramen, 1i0n, Red Worm, Adore, Cheese, lpdw0rm, and
                Slapper show that Linux now has a virus
                problem?</strong></p>

                <p>No, they demonstrate that the computer press
                doesn't understand network security, and reprints
                <a href="http://www.v3.co.uk/vnunet/news/2115032/bug-watch-linux-safe-attack">boilerplate
                self-promotion from the anti-virus industry</a> in
                lieu of news and analysis. Saying these display a
                "virus problem" is like saying a homeowner had a
                "fire hazard problem" after he/she left his/her home wide
                open and unoccupied for six months, then burglars
                finally noticed the house, stole its valuables, and
                finally torched it.</p>

                <p>To explain: None of these Linux worms break into
                systems directly, but rather perform automated
                "script-kiddie"-style probes for specific obsolete,
                security-vulnerable network daemon (server)
                software versions. Typically, those vulnerabilities
                they seek were found and fixed <em>months or years
                ago</em> — and heavily publicised. At which point,
                everyone with a grain of common sense upgraded.</p>

                <p>If you run a Linux (or other Unix) system and
                choose to have it offer network services,
                especially using overly complex,
                security-problematic software such as BIND v. 8 and
                WU-FTPd, it is an elementary fact of life that
                failing to heed security advisories and update your
                software when necessary means you may have your
                valuable business plans and other confidential data
                stolen or subtly sabotaged. You may find yourself
                arrested and tried for crimes you seem to have
                committed using your computer. You may give
                faceless strangers the means to believably
                impersonate you for their own purposes. You may see
                your and (sometimes) your company's reputation
                injured, and your career in ruins. You may suffer
                immense financial losses.</p>

                <p>The point? "Linux worms" don't even rate in the
                catalogue of disaster you may suffer, if you have
                given the bad guys a dirt-easy way to seize total
                control of your system anonymously from anywhere in
                the world. Thus, people who fixate on the (at best)
                adding-insult-to-injury threat of "Linux worms" do
                not understand the subject of <a href="http://web.archive.org/web/20080427075329/http://security.itworld.com/4352/LWD000829hacking/pfindex.html">
                real network security</a> at all.</p>

                <p>For the sake of completeness, I should also mention
                that there's nothing Linux-specific about those
                "worms": Since the attack is against long-notorious
                vulnerabilities in widely-used network daemon
                software, they can be trivially modified to find
                and exploit such holes on other platforms where
                those packages run. But really, even that runs the
                risk of obscuring the real point: "Worm" attacks
                are not <em>themselves</em> a security issue, but
                rather one of the lesser consequences that
                typically result from ignoring <em>real</em>
                security issues for ludicrous lengths of time.</p>
                </li>

                <li><p><a name="virus4"></a><strong>Isn't Microsoft 
                Corporation's market
                dominance, making Linux an insignificant target,
                the only reason it doesn't have a virus
                problem?</strong></p>

                <p>Not at all. This question is virus pundits'
                <a href="http://www.bartleby.com/81/13489.html">pons
                asinorum</a>: If they can't think past this
                fallacy, don't even try to reason with them, as
                they're hopelessly mired in rationalisation.</p>

                <p>The speaker's supposition is that virus writers
                will (like himself/herself) ignore anything the least bit
                unfamiliar, and attack only the most-common user
                software and operating systems, thus explaining why
                Unix viruses are essentially unknown in the field.
                This is doubly fallacious: 1. It ignores Unix's
                dominance in a number of non-desktop specialties,
                including Web servers and scientific workstations.
                A virus/trojan/worm author who successfully
                targeted specifically Apache httpd Linux/x86 Web servers
                would both have an extremely target-rich
                environment and instantly earn lasting fame, and
                yet it doesn't happen.</p>

                <p>2. Even aside from that, it completely fails to
                account for observed fact: Assume that only 1% of
                Internet-reachable hosts run x86 Linux (a
                conservative figure). Assume that only one virus
                writer out of 1000 targets Unixes. Then, given the
                near-instant communication across the Net that at
                this writing is blitzing my Linux Web server with
                dozens of futile probes for the Microsoft "Nimda"
                vulnerability per second, the product of that one
                virus writer's work should be a nagging problem on
                Linux machines everywhere — and he/she will be working
                very hard to achieve that, given the bragging
                rights he/she would gain. Yet, it's not there. Where is
                it?</p>

                <p>The answer is that, for various reasons discussed
                in prior essays, such code is very easy to write,
                but — given minimally competent system maintenance
                (including the automated kind, cited below) — 
                completely impractical to propagate. And likely to 
                remain so.</p>
                </li>

                <li><p><a name="virus5"></a><strong>But how can you say there's no virus problem, when there have been several dozen Linux viruses?</strong></p>

		<p>First of all, that's not what I said.  (People keep
                failing to heed what these essays <em>actually say</em>.)  
                I said that Linux systems' architecture and culture, by 
                design, resist such petty nuisances, and create sufficient 
                default protections that anyone careless enough to be 
                exposed to Linux "malware" (viruses and such) has bigger 
                and more fundamental worries:  By and large, you 
                <a href="http://www.theregister.co.uk/2003/10/06/linux_vs_windows_viruses/">can be hit at all only by being really dumb</a>.  
                By and large, you can suffer <em>system</em> (root) 
                compromise from malware only by being mind-bogglingly 
                dumb.</p>

                <p>Moreover, especially since the year 2000, even reckless, 
                dumb Linux users have been adequately protected against 
                the consequences of likely types of gross negligence, by 
                automated system updaters.</p>

                <p>Let's get into specifics.  Here's a detailed profile 
                of literally all Linux malware to date (2004):</p>

                <h3>I.  ELF Infectors:</h3>

                <p>Abulia, Alaeda, Balrog, Bi, Binom, Bliss, Brundle,
                Caline, Cassini, Cron, Cyneox, Dataseg, DebiLove, DerFunf, 
                Dido, Diesel, Dummy, 
                Eriz, Eternity, Gildo, Godog, Grip, Gzid, Henky, Herderv, Hyp, Jac, Kagob, Kaot, 
                Laurung, Mais, Mandragore, Mixter, Nel, 
                Nemox, Neox, Nf3ctor, Nuxbee, Obsidian.E (Obsid), Orig, OSF, Ovets, Pavid 
                (Alfa.dr), Penguin, Quasi, RST = Remote Shell Trojan,
                Radix, RcrGood, Rike (Rike.1627), Satyr, 
                Sickabs, Siilov, Silvio, Simile (Etap, MetaPHOR), 
                Spork, Staog, Svat, Telf, Thebe, Vit (4096, Vit.4096, Silly), 
                Winter (Lotek, LoTek), Winux (Lindose, PEElf, Pelf), 
                Wozip, Xone, Ynit, and Zipworm
                (distinctive only in that it likes to infect ELF files 
                in Zip archives).</p>

                <p>These are all "ELF infectors", where "ELF" is the 
                standard Unix binary format.  To activate these, you 
                must literally decide to run a binary infected with them, 
                e.g., someone mails you a binary file and says "Please 
                run this not-especially-trustworthy binary executable."
                Doing so would of course be really dumb; the consequence 
                of being dumb in that particular fashion is that some 
                number of Linux executable binaries set to be writable 
                by the user's account would get modified to include a 
                copy of the virus ("infected").  Note that the user is 
                thereby enabled only to shoot at his/her <em>own</em> 
                foot:  No regular installed applications could be 
                affected, because those are not writable by regular 
                users: Only binary executables in that specific user's
                /home/username/bin/ and such could be affected (and 
                seldom do users have any).</p>

                <p>And, perhaps needless to say, anyone who runs 
                untrustworthy binary executables <em>using the root 
                account</em> is a dumb cluck, and hopeless.  Further, 
                you really, really have to go out of your way to run 
                them at all:  For example, literally none, zero, nada 
                of the <a href="http://linuxmafia.com/faq/Mail/muas.html">more than 100 e-mail clients for Linux</a> 
                auto-execute received executable attachments on the user's 
                behalf.  The user would have to save the attachment to
                /tmp, run "chmod u+x" on it to make it executable, and 
                then manually run it — in order to (finally) shoot 
                himself/herself (but not his/her system) in the foot.</p>

                <p>Even though the category of "attack" is slightly 
                different, the epic degree of inventive and energetic 
                haplessness that would be required to <em>actually hurt 
                a system</em> with one of these was nicely illustrated
                by my summaries (<a href="http://www.oreillynet.com/cs/user/view/cs_msg/46829">1</a>,
                <a href="http://www.oreillynet.com/cs/user/view/cs_msg/46832">2</a>)
                of the October 2004 "phishing attack" aimed at Red Hat 
                users.</p>

                <p>One last observation about ELF infectors:  They're all 
                fundamentally identical, and might as well all be the 
                same virus.  Seen one, seen 'em all.  (More to the 
                immediate point:  Easily avoid running one, easily avoid 
                running 'em all.)</p>

                <h3>II.  Automated Attack Tools against Obsolete Network Daemons:</h3>

                <p>This category is the one that former SecurityFocus 
                staffer "Blue Boar" (Ryan Russell, former moderator of 
                the Vuln-Dev security mailing list) cited, on my user 
                group mailing list, in supposed answer to my "Yet, it's 
                not there.  Where is it?" rhetorical question (above), 
                asking where's the first virus massively attacking 
                Linux and making its author famous.  In reply, he claimed 
                to have seen Internet-traffic logs proving that 
                "<a href="http://linuxmafia.com/pipermail/conspire/2003-September/000291.html">thousands</a>" 
                of Red Hat systems had been infected by "1i0n" and 
                "lpdw0rm".</p>

                <p>Background:  Starting with the Sept. 25, 2000 
                <a href="http://linuxmafia.com/faq/RedHat/releases.html">release of Red Hat Linux 7.0</a>, 
                Red Hat, Inc. provided automatic, free-of-charge  
                security updates through its "Red Hat Network" (RHN) 
                service.  Much of the discussion that follows will be 
                Red Hat-centric, in part because some or all of the 
                attack tools function only within Red Hat's shell
                environment and break elsewhere.  However, the same 
                network daemons were equally vulnerable at one time on 
                other Linux distributions and (in many cases), indeed, 
                on other OSes including MS-Windows (e.g., BIND).  The same
                comments about avoidance apply elsewhere.</p>

                <p>Here are my notes on the "worms" mentioned.  ("Worm" 
                in this context is just a scare-word meaning someone's 
                canned remote-attack tool against a piece of 
                network-accessible software your system may or may not 
                have running and exposed to outside connections.)</p>

                <ul>
                    <li>
                    <p>
                    <strong>Name:</strong> 1i0n (lion)<br>
                    <strong>Appeared:</strong> March 23, 2001.<br>
                    <strong>Vulnerable:</strong> BIND8 prior to 8.2.3, 
                    via the "TSIG" exploit of Jan. 29, 2001.  Note BIND9 
                    initial release, Sept. 15, 2000; BIND 9.1.0 release, 
                    Jan. 17, 2001.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> lpdw0rm (lpdworm, Kork, Abditive)<br>
                    <strong>Appeared:</strong> April 2001.<br>
                    <strong>Vulnerable:</strong> Berkeley lpd printing 
                    package, via an input validation bug; fixed in lpd's 
                    Oct. 2000 release.</p>

                    <p>Both Berkeley lpd and BIND8 were / are 
                    notoriously buggy network daemons, and neither was 
                    necessary or recommended unless you were running
                    particular types of server machine.  If you decided to 
                    run them anyway, pretty much everyone advised you to 
                    always stay absolutely current on security fixes.  
                    Fortunately, the above worms were no threat:  The holes
                    they attack had already been fixed two and six months 
                    earlier, respectively, by the time the worms made 
                    their debuts.</p>
                </li></ul>

                <p>Running a known-vulnerable release of BIND8 or lpd was 
                not merely obviously foolhardy, but also difficult to do 
                starting on RH 7.0 and above because of RHN, which would 
                inform even a near-comatose sysadmin that a new security 
                fix is available, and would he/she like it retrieved
                and installed (Y/n)?</p>

                <p>Moreover, CUPS had long been the preferred successor 
                to lpd by 2000, and ditto the from-scratch-rewritten 
                BIND9 replacement for BIND8, which by version 9.1.0 was 
                quite sound.</p>

                <p>So, being hit by either worm on Red Hat required either 
                still running long-obsolete RH 6.2 (or earlier) with 
                zero maintenance &amp; obsolete network daemons still 
                running, or practically willfully sabotaging all efforts 
                to make effective maintenance easy and the path of 
                least resistance.  And, the fact that Russell trumpeted
                "thousands" of such systems allegedly having succumbed 
                during those worms' heydays, out of some estimated 
                10 to 20 million Linux systems on the Internet in 2001, 
                is conceivably credible but not very impressive.
                (Reliable censuses of in-service Linux machines are 
                notoriously difficult; IDC analyst Dan Kuznetsky 
                <a href="http://www.informationweek.com/story/IWK20010613S0012">
estimated</a> 
                in 2001 that Linux comprised 27% of the then-current 
                market for new server hardware, and deployments had been 
                accelerating for a decade.)</p>

                <p>Then, too, consider the source:  Russell seriously 
                claimed that pathetic ELF-infectors RST.A, RST.B, and 
                OSF were "<a href="http://linuxmafia.com/pipermail/conspire/2003-September/000293.html">the most successful Linux viruses [he'd] seen in the wild</a>" 
                and faulted these essays for not having covered them.    
                Later, when challenged about what "successful" and 
                "in the wild" meant, he admitted that he meant that some 
                (unspecified, small) number of extremely 
                <a href="http://linuxmafia.com/pub/humour/gullibility-virus">gullible</a>
                people, whom he claimed to know, had downloaded supposed 
                software-cracking (or security-cracking) utilities from 
                anonymous underworld strangers (who had virus-infected them) 
                and run those supremely suspect "warez" with root 
                authority.</p>

                <p>(By the way, Russell casually mentioned in that 
                conversation that he leaves himself logged into Linux 
                desktop machines as the root user as a matter of deliberate 
                policy, saying only "I know what I'm doing", and sees 
                nothing wrong with doing so — and likewise 
                habitually uses the Administrator login on MS-Windows.  
                Both are, of course, novice-user bad habits and create 
                needless system risk with little benefit.)</p>

                <p>Such is our famous "virus threat" — but let's 
                also cover all the other Linux worms, to date:</p>

                <ul>
                    <li>
                    <p>
                    <strong>Name:</strong> Cheese<br>
                    <strong>Appeared:</strong> May 22, 2001.<br>
                    <strong>Vulnerable</strong> BIND8 prior to 8.2.3, via 
                    the "TSIG" exploit of Jan. 29, 2001.  Note BIND9 
                    initial release, Sept. 15, 2000; BIND 9.1.0 release, 
                    Jan. 17, 2001.</p>

                    <p>This is a near-twin of 1i0n; the same comments apply.  
                    (Oddly, it seems to have been intended to 
                    <a href="http://web.archive.org/web/20041114141103/http://www.linuxsecurity.com/feature_stories/feature_story-90.html">repair 1i0n-cracked systems</a>.)
                    Note that the hole that Cheese attacks had already 
                    been fixed for four months.</p>


                    </li><li>
                    <p>
                    <strong>Name:</strong> Adore (Red)<br>
                    <strong>Appeared:</strong> April 04, 2001.<br>
                    <strong>Vulnerable:</strong> LPRng printing package, 
                    via an input validation bug discovered December 12, 
                    2000.<br>
                    <strong>Vulnerable:</strong> rpc-statd daemon, via an input
                    validation bug discovered August 18, 2000.<br>
                    <strong>Vulnerable:</strong> wu-ftpd daemon v. 2.6, 
                    via an input validation bug discovered July 7, 2000.<br>
                    <strong>Vulnerable:</strong> BIND8 v. 8.2.3, via 
                    several buffer overflow and input validation bugs 
                    discovered Jan. 29, 2001.</p>

                    <p>This worm tried a grab-bag of attacks, against four 
                    separate server-role packages, all (like those 
                    previously discussed) notoriously prone to
                    security holes, <em>but</em> please note that the 
                    holes it attacks had already been fixed two, eight, 
                    nine, and three months previously, respectively.</p>

                    <p>The worm should not be confused with the 
                    <a href="http://lwn.net/Articles/75990/">Adore aka
                    adore-ng rootkit</a>, which is of course (like other
                    rootkits) not an attack tool but rather an academic 
                    example of how to hide after system intrusion.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> Ramen<br>
                    <strong>Appeared:</strong> January 17, 2001.<br>
                    <strong>Vulnerable:</strong> wu-ftpd daemon v. 2.6, 
                    via an input validation bug of June 22, 2000.<br>
                    <strong>Vulnerable:</strong> rpc.statd daemon, via 
                    a bug fixed summer 2000.<br>
                    <strong>Vulnerable:</strong> LPRng printing package, 
                    via an input validation bug of Aug. 2000.</p>

                    <p>Notice the pattern?  This is a near-twin of Adore, 
                    and no more significant:  The holes it attacks has 
                    already been fixed seven, approximately seven, and 
                    five months previously, respectively.  And this is 
                    what we'll be seeing for all the other worms, time 
                    and again.  (One anti-virus vendor, Sophos, also 
                    speaks in its malware bestiary of an otherwise-unknown 
                    November 2001 Linux worm named "Honeymoo" attacking
                    the same years-obsolete wu-ftpd version that Adore 
                    and Ramen did.  It might be the same attack code, 
                    recycled.  It's difficult to tell, given absence 
                    of details.)</p>

                    <p>(A programmer group named TESO released in April
                    2002 a slight variant on Ramen named "7350wurm" that
                    attacked a glob() heap corruption bug in 
                    wu-ftpd v. 2.6.1, but that glitch had already been 
                    fixed for five months.)</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> Slapper (Cinik, Unlock,
                    bugtraq.c, Apache/mod_ssl worm)<br>
                    <strong>Appeared:</strong> Sept. 13, 2002.<br>
                    <strong>Vulnerable:</strong> A very specific and 
                    rare combination of Apache httpd with OpenSSL 
                    0.9.6d / 0.9.7beta1 or earlier, via an OpenSSL buffer
                    overflow fixed July 2, 2002.</p>

                    <p>This worm attacks only e-commerce and other 
                    SSL-enabled Web sites with particular obsolete 
                    versions of OpenSSL and Apache httpd configured in a
                    particular way, and the (exotic) hole it attacks had 
                    already been fixed for two months.</p>

                    <p>Note: This worm should not be confused with the 
                    Internet-crippling January 25, 2003 Microsoft "Slapper" 
                    worm, AKA 
                    <a href="http://web.archive.org/web/20041009144838/http://www.robertgraham.com/journal/030126-sqlslammer.html">SQL Slammer or Sapphire</a>, 
                    that within about ten minutes subverted a 
                    quarter-million MS-Windows desktop machines running 
                    the Microsoft Desktop Engine (MSDE) 2000 embedded 
                    database with a network listener fully exposed to 
                    public networks. (News reports calling SQL Slammer
                    — which, by the way, 
                    <a href="http://web.archive.org/web/20061024113636/http://www.issadvisor.com/viewtopic.php?t=118">conventional MS-Windows virus checkers cannot detect</a> —
                    an attack on MS-SQL Server were substantively in 
                    error.)</p>

                    <p>Yankee Group senior stock analyst Laura DiDio, 
                    renowned as pretty much the <em>last person on Earth</em> 
                    to figure out that SCO Group press releases should 
                    not be 
                    <a href="http://web.archive.org/web/20061020081522/http://en.wikipedia.org/wiki/Laura_DiDio">taken at face value</a>, 
                    <a href="http://web.archive.org/web/20050404041918/http://www.fcw.com/fcw/articles/2004/0503/feat-linux3-05-03-04.asp">claimed</a>
                    that Slapper compromised 20,000 Linux systems worldwide 
                    in 2002, but, even though that's a minuscule percentage 
                    of Linux deployments by 2002, it seems a bit unlikely 
                    even before considering the source:  To be hit, a 
                    sysadmin would need to be both advanced enough to 
                    install/configure a mod_ssl/Apache https-capable Web 
                    site — something one associates with professional 
                    paranoia — <em>and</em> too incompetent to bother 
                    applying crucial (and semi-automated) system updates.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> Mighty (Devnull)<br>
                    <strong>Appeared:</strong> Oct. 3, 2002.<br>
                    <strong>Vulnerable:</strong> A very specific and rare 
                    combination of Apache httpd w/OpenSSL 0.9.6d and 
                    0.9.7-beta1 or earlier, via an OpenSSL buffer overflow 
                    fixed July 30, 2002.</p>

                    <p>This was near-indistinguishable from the equally 
                    ineffective Slapper worm (above), and might as well 
                    have been the same code.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> Adm (ADMworm, ADMw0rm)<br>
                    <strong>Appeared:</strong> May 1998.<br>
                    <strong>Vulnerable:</strong> BIND8 buffer overflow 
                    prior to 8.1.2 (in the reverse query function, 
                    "fake-iquery yes;", which is disabled by default).  
                    Fix released April 8, 1998.</p>

                    <p>The hole in question had been fixed for only a 
                    month, which might have made it a plausible threat 
                    except that "fake-iquery" is pretty much always 
                    disabled.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> SSHD22<br>
                    <strong>Appeared:</strong> Oct. 2001.<br>
                    <strong>Vulnerable:</strong> OpenSSH exploit effective 
                    prior to v. 2.3.0.  Old versions were patched Feb. 
                    27, 2001; 2.3.0 released November 2000.</p>

                    <p>People already had this hole patched for either 
                    eleven or eight months, depending on whether they 
                    were willing to jump to v. 2.3.0 or not.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> Millen (Millenium, MWorm, Mworm)<br>
                    <strong>Appeared:</strong> Nov. 18, 2002.<br>
                    <strong>Vulnerable:</strong> wu_imapd daemon, via a 
                    buffer overflow fixed May 11, 2002.<br>
                    <strong>Vulnerable:</strong> qpopper daemon, via a 
                    buffer overflow fixed March 2002.<br>
                    <strong>Vulnerable:</strong> BIND8 through v. 8.3.3, 
                    via a buffer overflow fixed Nov. 11, 2002.<br>
                    <strong>Vulnerable:</strong> rpc.mountd daemon, via 
                    a buffer overflow fixed in 1998.</p>

                    <p>This bag-of-tricks worm attacks holes already fixed 
                    for six months, eight months, a week, and several years, 
                    respectively.  Now, I have to admit that only a week's 
                    lead time on fixing a critical security hole could be 
                    a real problem if you were asleep at the wheel and your
                    semi-automated updating mechanisms were broken or 
                    disabled — except who in his/her right mind 
                    was still running BIND8 by late 2002?  It hadn't
                    even been a standard Linux package in a year or so.</p>

                    </li><li>
                    <p>
                    <strong>Name:</strong> Sorso<br>
                    <strong>Appeared:</strong> July 2, 2003.<br>
                    <strong>Vulnerable:</strong> Samba prior to v. 
                    2.0.10 / 2.2.8a, via a buffer overflow.  Those fixed 
                    versions were released April 7, 2003.</p>

                    <p>This is the only Linux worm to date targeting the 
                    <em>Samba</em> server-role package's obsolete versions, 
                    possibly because even reckless server admins tend to 
                    know that Microsoft file/print sharing isn't safe to 
                    make accessible to the global Internet — just 
                    like the aforementioned rpc.mountd and rpc.statd 
                    daemon processes (part of NFS, Network File System 
                    — or No Friggin' Security as the wags would 
                    have it).  In any event, the attacked holes had 
                    already been fixed for three months.</p>


                   </li><li>
                   <p>
                   <strong>Name:</strong> Lupper (Lupii, Plupii, Mare)<br>
                   <strong>Appeared:</strong> Nov. 11, 2005.<br>
                   <strong>Vulnerable:</strong> PHPXMLRPC messaging
                   library v. 1.1.1, via URL input validation bug enabling
                   execution of arbitrary PHP.  Fixed Aug. 8, 2005.<br>
                   <strong>Vulnerable:</strong> AWstats Web-statistics
                   Perl CGI script, v. 6.3, via a URL input validation bug.
                   Fixed June 10, 2005.<br>
                   <strong>Vulnerable:</strong> Darryl C. Burgdorf's WebHints
                   proprietary "thought for the day" Perl CGI script, v. 1.02, 
                   has <em>zero</em> URL input validation, a
                   design failure publicised May 9, 2005.
                   (References to v. 1.03 and 1.3 are in error.)<br>
                   <strong>Vulnerable:</strong> Jimmy's "The Includer"
                   proprietary SSI-emulation Perl CGI script v. 1.1, has
                   <em>zero</em> URL input validation, a
                   design failure publicised March 3, 2005.

                   </p><p>This worm — exploiting vulnerabilities already
                   fixed or eliminated for three, five, six, and eight months,
                   respectively — derived from the earlier Slapper worm 
                   codebase.  Thus far, it exists only as an i386
                   Linux binary, fetched to target Web
                   servers' /tmp directory by one of 
                   the four obsolete, vulnerable Web apps, and then 
                   run as httpd.  One of those exploits (against 
                   PHPXMLRPC) would work equally well (after recompiling 
                   the worm) on any operating system.  The others
                   invoke Bourne-like shells (and thus 
                   are feasible on any Unix, but on MS-Windows only 
                   with Cygwin, etc.). The AWstats exploit also calls wget,
                   via buggily-parsed URL input of the form
                   "configdir=|program".

                   </p><p>The Includer and WebHints CGIs' failures to validate 
                   input are <em>total</em>:  URLs 
                   "http://www.example.com/hints.pl?|program|", 
                   "http://www.example.com/includer.cgi?|program|", and
                   "http://www.example.com/includer.cgi?template=|program|" 
                   all remotely execute "program".  However, it's important
                   to note that <em>neither is packaged</em> by Linux 
                   distributions:  Either would have to be downloaded
                   and installed manually by an admin of uncommonly
                   bad judgement. 

                   </p><p>The AWstats CGI, by contrast, is sometimes 
                   packaged but never to the best of my ability to tell 
                   installed by default, in any Linux distribution:  It has 
                   historically been notorious for input validation
                   flaws, and thus is best run in its optional
                   <a href="http://www.debian-administration.org/articles/85">
                   configuration that generates static HTML pages</a>, 
                   rather than its default CGI mode.

                   </p><p>PHPXMLRPC is usually offered via optional, 
                   supplemental PHP-add-ons packages but is never to the
                   best of my ability to tell installed by default, in 
                   any Linux distribution.  Like the related and identically
                   vulnerable (fixed the same day, but not attacked 
                   so far by this worm) PEAR XML-RPC v. 1.3.3 messaging 
                   library, it would probably get installed as part 
                   of overfeatured, developed PHP-based Web applications such 
                   as Ampache, b2evolution, egroupware, MailWatch for
                   MailScanner, Nucleus CMS, phpmyfaq, phpPgAds, 
                   phpgroupware, PostNuke, TikiWiki, and Xaraya; 
                   plus older versions of Civicspace and Drupal.
                  
                   </p><p>(The two PHP-coded XML-RPC implementations should
                   not be confused with PHP's optional xmlrpc-epi extension, 
                   in C, included with PHP since v. 4.10, or various other
                   non-PHP implementations.)
 
                   </p><p>One lesson that's common to all of those exploits
                   is that Linux Web-server admins need to be extra careful
                   of applications that will process public data, e.g., via
                   URL input, and doubly careful (lest they miss needed
                   fixes) of any they choose to install outside
                   their distributions' regular maintenance regimes.
                   As it happens, the worm requires rather rare (not 
                   to mention old) Web-app vulnerabilities, and extremely
                   few systems have been reported affected.  ("Affected"
                   means that the attacker can compromise the httpd 
                   process but not the Web host as a whole, without some
                   separate and more serious method to compromise
                   the machine.)

                   </p></li><li>
                   <p>
                   <strong>Name:</strong> Others — you tell me.  
                   I might have missed some.</p>  

                   <p>If I did, long odds favour the story being same 
                   as with those above.  You might search, for example, 
                   <a href="http://web.archive.org/web/20041011110030/http://www.digitaloffense.net/worms/">JD Moore's archive</a>,
                   <a href="http://web.archive.org/web/20070309180346/http://www.treachery.net/%7Ejdyson/infosec/trojans/">
                   Treachery Unlimited's archive</a>, 
                   the <a href="http://www.29a.net/">29 A Group</a>, 
                   <a href="http://web.archive.org/web/20061026121416/http://www.madchat.org/">MadChat</a>, 
                   <a href="http://vx.netlux.org/rrlf/">RRLF</a>, Herm1t's
                   <a href="http://vx.netlux.org/">VX Heavens Virus 
                   Collection</a>, <a href="http://www.thehackademy.net/madchat/vxdevl/">Hack Academy</a>, or request access to 
                   <a href="http://www.spywareinfoforum.com/">SpywareInfo's 
                   repository</a>.  Beware that some collections'
                   "Linux" entries actually work
                   only on certain other Unixes (usually FreeBSD or 
                   Solaris — e.g., the 2002 Scalper AKA Ehchapa worm
                   on FreeBSD and the BoxPoison worm on Solaris), though 
                   <a href="http://www.v3.co.uk/vnunet/news/2120227/honeymoon-linux-users">often 
                   misreported</a> as Linux code.</p>
               </li></ul>

               <p>My overall point is that, especially starting around 
               2000 when automated and semi-automated maintenance regimes 
               became ubiquitous in Linux distributions, even just 
               following the path of least resistance and not being a 
               particularly competent admin would have closed off the above
               holes long before they could be exploited by "viruses".  
               Also, Red Hat in RH 7.3 (May 2002) and other distributions 
               about the same time started defaulting to enabling iptables 
               port-filtering ("firewall") scripts at startup by default 
               &amp;mdash again, protection even for those who haplessly
               switch on obsolete network daemons.</p>

               <p>Beware, too, of vacuous claims like that of Forrester 
               Research senior analyst Laura Koetzle's 
               <a href="http://news.techworld.com/security/1329/forrester-questions-linux-security/">privately circulated April 2004 study</a> 
               claiming that major Linux distributions were typically 
               "at risk" during 2002-3 for a disturbingly long period, 
               longer than current Microsoft OSes were.  In Koetzle's
               case, the sleight of hand occurs in her definition of 
               "risk" as the number of days from availability of a 
               source patch to the distribution's release of a package 
               update.  This ignores the crucial fact that Linux 
               distributions' software patches for security holes are 
               just about invariably anticipatory:  They come out many 
               months before anyone figures out how to exploit the
               hole, if ever — whereas Microsoft's patches 
               very often "patch" an already exploitable security 
               disaster.  Moreover, Koetzle made the fatal error of 
               weighting all "security" issues equally, regardless of
               whether they were serious or even potentially 
               exploitable at all.   Last, Koetzle made the tediously 
               familiar error of comparing major Linux distributions
               each comprising <strong>both</strong> the core OS and 
               several thousand optional application and server packages 
               against only Microsoft's core OS <em>with hardly any 
               bundled applications at all</em>, but still considered the
               relative "patch counts" meaningful.  That's like comparing 
               the total number of murders in the Vatican in 1998 (3) 
               with those in Canada (555), and concluding that 
               Canada is 185 times as dangerous a place.</p>

               <p>(News reports citing that study seem oddly reticent 
               about which customer commissioned it.  This may be of 
               interest given that a 
               <a href="http://www.itworld.com/031006forrester">frequent customer</a> 
               has used Forrester Research frequently in its ongoing 
               anti-Linux campaign, often through subsidiary firm 
               Giga Research.)</p>

               <p>Incidentally, a brief note to anyone intending to 
               draft yet another Linux vs. MS-Windows security comparison 
               and aspiring to <em>get it right for a change</em>:  Please 
               jot down all Apache httpd and BIND items in <em>both 
               columns</em>.  Those open-source packages are widely used
               on MS-Windows servers, too.</p>

               <p>And a note to admins:  Don't panic about an installed 
               package having a "vulnerable" version number until you've 
               checked your distribution's security-alert pages:  You 
               may well have received the fix as a "backport" to stable 
               package code, thereby fixing the package without incrementing
               its version number.  This practice is customary, for example, 
               on Debian's stable branch.</p>

               <h3>III.  Buggy or Obsolete User Apps Exposed to Public Data:</h3>

               <p>And yes, failing to update regular, non-network-daemon 
               <em>user</em> apps could lead to data loss and possibly 
               personal embarrassment (albeit not <em>system</em> 
               compromise):</p>

              <ul>
                  <li><p><strong>Name:</strong> JBells (JBellz)<br>
                  <strong>Appeared:</strong> January 14, 2003<br>
                  <strong>Vulnerable:</strong> The proprietary mpg123 
                  music-playing app's buggy non-production v. pre0.59s 
                  beta, but not prior or subsequent production versions, 
                  via a buffer overflow induced by trojaned (specially
                  malformed) MP3 files played using it, having binary 
                  code in the MP3 frame header that invokes a shell and 
                  recursively deletes the user's home directory.</p>

                  <p>This exploit code was very brittle — needing 
                  to be customised for specific mpg123 releases on 
                  particular Linux distributions and so ever working, 
                  even theoretically, only on a couple of them — and
                  the tiny window for overflow code didn't permit any 
                  <em>complex</em> hostile actions.  However, more 
                  significant is that this affected only one buggy beta 
                  (fixed the same day) — even the prior pre0.58r 
                  beta was immune — that didn't meet quality 
                  standards for inclusion in any Linux distribution.</p>
              </li></ul>

              <p>But it is worth noting the point, that data posted on the 
              public Internet may in some cases be used to subvert user 
              apps having severe, known flaws in their input validation 
              routines — e.g., Web browsers, multimedia plugins/apps, 
              e-mail readers, and print daemons.   This isn't news to us 
              of the Linux community, either:  It's why you should keep those 
              packages — like network daemons you choose to run, 
              kernels' network stacks, and other security-sensitive code 
              — up to date and eschew ones known to be particularly 
              bug-prone or unmaintained.</p>

             <p>Anti-virus pundit and Linux critic Phil d'Espace 
             <a href="http://web.archive.org/web/20041105040939/http://www.virusbtn.com/magazine/archives/200209/linux_malware.xml">feels</a> 
             that such an application exploit should be able to trivially 
             escalate to root privilege:  The particulars of JBells show 
             that this sort of talk is cheap, that <em>examples</em> of 
             such trivial escalation are nonexistent (and why), and that 
             security-industry commentators have a lamentable tendency 
             to shade the truth.  (E.g., d'Espace postulates that a
             remotely compromised instance of Apache httpd, even though 
             running as an unprivileged user, could be caused to overwrite 
             "all the files on the Web site", ignoring the fact that 
             <strong>no</strong> files within the httpd document root are 
             or should ever be owned by that process's designated 
             runtime user.)</p>

             <h3>IV.  The Ringers.  Post-Compromise Rootkits (Trojan, Worm) 
             and Attack Tools (not malware at all):</h3>

             <p>Apologies to those for whom this subject is old hat, but the
             following nasty packages do not qualify as Linux malware in any
             meaningful sense:</p>
             
             <p>Abrox, Adminer, Adore and Adore-ng (rootkits by authors 
             "TESO" and "stealth", 
             not to be confused with the remote-attack worm of the same name), 
             afhrm, AjaKit, Alcohol, Alk, Ambient (ark), Andrada, Anonoying, 
             aPa, Arang, Arkdoor, asp, Attack,
             Backserv, Banner, Batamacker, Battlec, Beasted, BeastKit, 
             bindshell, Blackhole, 
             Blitz (Bliz), Bloop, BlowFish (BF), Bnc, BOBKit, 
             Bodoor (BO), Bofishy, 
             Bonk, Boost, Bouncer, Brk, Bscan, Bshell, Caplen, CGI, CGIexp,
             Chass, Chfn, Chrome, Ciscer, Clifax, CleanLog, 
             Clripch, Corn "worm", Cwd, Cyrax, Cyrus, Da2, Dancer, 
             Danny-Boy's Abuse Kit, Dar,
             Darkux, Darkwar, DC, DCom, Dcomer, demonKit, Demonul, 
             Desida, Devil, Dexterois, Dica, Digit, Divine, Dmp,
             Dnstroyer, DobDrag, Drakat, Dreams, Drugkit, Duarawkz, 
             Ducoci, ELF_Gmon.a (sets up a backdoor on UDP port 3049; 
             included in SuckIT), Echo, Echosrv, Eko, Elfpatch, Elfwrsec, 
             Escal, Espacker, Ethereal, Evil, 
             Excedoor, Explodor, Faker, Fixer, Fkit, Flea, 
             Flooder (Icmp), Fmtxp, Foda, Fork, 
             Fpatch (Fakepatch, ShcBased), Fpath, Freeze, Frezer, 
             Front, Fuck'it, FunSeven, 
             Fusys, Gabitzu, GasKit, Gata, Gbkdor, Gizc,
             Glock, GMM, Gold2, Guile, Gulzan, Gummo, Hacktop, Haploit, heroin, 
             Hella, Hestra, Hider, HiddenFunc, HiDrootkit, Hife, 
             Hijack (Hijacker), HitWins, HjC, 
             Homador, Hopbot, ibnoKit, Igmp, IIS-Attacker, IISuxor, 
             Ikproc, Imspd,
             ImperalsS-FBRK, Infect, Initen, InjWrap, Interbase, Ircd, 
             IRCKiller, Irix, Iroffer, itf, 
             Kaiten (Kayten), Kaot, Kbd, Keitan, Kidbin, 
             KIS, Kitko, KldHide, Kmod, Knark, Knight, Kod, Koka, Kokain, 
             Kot, Krepper, Lacksand, Lala, Lambida, lbd, Lime, Lindoor, Linspy, 
             Linux Rootkit (LRK), Livthe, lkm, LkmHide, LOC, 
             Lockit (LJK2), Logftp, LuCe LKM, 
             Luckroot, Ltrap, Madvise, Maniac, Manpages, Map, Masan, Matrics,
             Maxload, Melt, Metti, Mhttpd, Micmp, Midav, Mirc, Mircforce, 
             Mithra, Mmap, mod_rootme, MonKit, Mr, MRK, MStream, Muench, 
             Mulexp, Mweb, Nestea, NetBus, Nhttpd, Ni0, Nkiller
             Nocwage, OBSD, Octopus, Omega "worm", OpticKit (Tux), Ovason, 
             Overdrop, Oz, Pass, PaulCyber, Phobi, PhsychoPhobia, 
             PLT, Poly, Pong, Popdoor, Portacelo, 
             ProcHider, ProcSuid, PsychoPhobia, Qitty, Quacker,
             R0nin, R3dstorm, Race, Raped, Rawsocket, Rbind, Reboot, Reflect, 
             Regen2k, Regile, Remprint, Resrcs, RemoteSync, 
             rexedcs, RH-Sharpe, Rial, 
             Ris, RK17, Romanian Rootkit, Rooter,
             Rootin, Rootkit, Rpc, Rpctime, RQPOP, RSHA, Sambex, 
             Sendxp, Senha, Shadoor, 
             Shaggy, ShcBased, ShellCode (Shellcode),
             Shinject, ShitC "worm", 
             ShKit, Siback, Showtee, Shutdown, SHV4, 
             SHV5, Sicmp, Sickabs, Sin, Sink, Sinkhole (SinkSlice, Slice), 
             Sirius,
             Sk, Slice, Smack, Small, Smurf, Sneakin, sniffer, 
             Snoopy, Snug, Soutown, Sprite, SQLexp, SSPing, Sstftp,
             Stach (stacheldraht), Stealer, Stream, Streamdoor, Subsevux, 
             SuckIT (Sckit, Skit), Suffer, Superkit, SVScan, Synapsis, 
             Synk, Sysniff, Synscan, Targ, TBD (Telnet BackDoor), 
             TC2, Tcpscan, Teso, Tesoelf, tfn (TFN), tfn2k, 
             THC, T0rn (t0rnkit), Trank, 
             Trinity, TRK, trinoo (Trin), Trojankit, Tsig, Tsunami, 
             Typot, UDP, Unfstealth, Unk, Untrace, 
             URK (Universal Rootkit) Usmel, VcKit, Vma, Volc, 
             Vulner, w55808, Wgcrash, Win, Winploit, WrapFtp, WrapLogin, 
             WrapPasswd, WrapSu, wted, Wudel, WuScan, XChatSouls, Xicmpfl, 
             XKeyLogger, Xmailer, Xpl, z2, Zab, zaRwT, and ZK.</p>

             <p>Every one of those is some sort of <em>post-attack</em> 
             tool; all are erroneously claimed on sundry anti-virus 
             companies' sites (and consequently in various news articles) 
             to be "Linux viruses".  Some are actually "rootkits", which 
             are kits of software to hide the intruder's presence from 
             the system's owner and install "backdoor" re-entry 
             mechanisms, after the intruder's broken in through other means 
             entirely.  Some are "worms" of the sort that get launched 
             locally on the invaded system, by the intruder, to probe it 
             and remote systems for further vulnerabilities.  Some 
             are outright attack tools of the "DDoS" (distributed 
             denial of service) variety, which overwhelm a remote target
             with garbage network traffic from all directions, to render it
             temporarily non-functional or incommunicado.</p>

             <p>The news reporters and anti-virus companies in question 
             should be ashamed of themselves:  None of the above, in 
             itself, can break into any remote Linux system.  All must 
             be imported manually and installed by an intruder who has 
             cracked your system by other means.</p>

             <p>That incompetent reporting sometimes has extremely damaging
             consequences:  In 2002, British authorities 
             <a href="http://www.nytimes.com/2002/09/20/international/europe/20VIRU.html?ex=1100840400&amp;en=db6e050c650a5013&amp;ei=5070&amp;oref=login&amp;todaysheadlines">arrested</a>
             the alleged author of the T0rn rootkit, based on their 
             mistaken notion that it's a "Linux virus".  (My efforts to 
             get the Reuters / NY Times story corrected were ignored, 
             except by cited anti-virus consultant Graham Cluley, who 
             told me he'd been misquoted.)</p>

             <p>I should mention in passing that feeble albeit genuine 
             malware like the RST and OSF ELF-infectors are often 
             downloaded and manually installed, locally, by attackers 
             <em>after they've entered and cracked root via other means 
             entirely</em>, often as part of their "rootkits".  Some of
             these help keep alive UDP-based backdoors to preserve 
             their ongoing access.  The point, again, is that they're 
             an <em>after-effect</em> of break-in, not a method of attack 
             in themselves.  It's like a burglar disabling your back-porch 
             doorlock from inside your kitchen; it's damage, but not the 
             guy's means of entry.</p>

             <h3>V.  In Summary:</h3>

             <p>There are 
             <a href="http://linuxmafia.com/faq/Security/breakin-without-remote-vulnerability.html">real threats</a> 
             to Linux security.  If you spend time looking for "Linux viruses" 
             — which, by and large, can come at your system only 
             if you <em>get behind them and push</em> — you might 
             miss the real threats and not do something useful like 
             <a href="http://web.archive.org/web/20080427075329/http://security.itworld.com/4352/LWD000829hacking/pfindex.html">
             studying your security profile</a> and 
             <a href="http://linuxgazette.net/issue98/moen.html">other 
             measures</a>.</p>

             <p>And yes, some "virus" author could in principle, some day, 
             in the very worst-case scenario — if he/she were able 
             to find a remotely exploitable Linux kernel network-code 
             flaw unknown to everyone else — unleash a devastating 
             and rapid, automated, surprise attack that clobbers 
             (compromises) within one hour a large percentage of, say, 
             worldwide Internet-connected i386 Linux servers' TCP/IP 
             stacks, and thus gains root control.</p>

             <p>This would force all afflicted systems to be offline for 
             a day to await the necessary patch and be rebuilt.  That 
             would be very annoying — but would hardly be 
             unrecoverable.  Moreover, I'll give very long odds against 
             this or less-central failures happening, too — 
             and lower ones for the same threat against practically 
             every other OS.</p>

             <p>Why?  Some of the reasons were articulated nicely in 
             (separate) analyses by 
             <a href="http://www.theregister.co.uk/security/security_report_windows_vs_linux/#winvslinuxdesign">Nick Petreley</a>, 
             <a href="http://www.faqs.org/docs/artu/ch03s02.html">Eric 
             Raymond</a>, and 
             <a href="http://linuxmafia.com/%7Ekarsten/Rants/spyware.html">
             Karsten M. Self</a>:</p>

             <ul>
                 <li>System was designed for multiuser and networked 
                 operation from the ground up.
                 </li><li>System was designed to distrust and not rely (in 
                 the general case) on remote procedure calls (RPCs), 
                 especially not between hosts.
                 </li><li>System is profoundly modular, with the simplest, 
                 most generic possible interactions (often via pipes 
                 or textual interchange — even if then layered 
                 over sockets, etc.) between components (which can 
                 thus be individually changed, patched, upgraded, 
                 removed, or disabled as desired — without, 
                 in general, large interdependency consequences or 
                 cascade failures).  Within that modular framework, 
                 functional substitutes exist and can be swapped in 
                 for almost all common security-relevant codebases.  
                 (E.g., if OpenSSH is having security problems, I 
                 can easily sidestep to LSH or any of 
                 <a href="http://linuxmafia.com/ssh/unix.html">several 
                 other</a> SSH daemons.  Ditto 
                 <a href="http://linuxmafia.com/%7Erick/faq/index.php?page=warez#httpd">Web servers</a>, 
                 <a href="http://linuxmafia.com/faq/Network_Other/ftp-daemons.html">ftp daemons</a>, 
                 <a href="http://linuxmafia.com/faq/Mail/mtas.html">mail servers</a>, 
                 etc.  If need be, I can even 
                 <a href="http://www.debian.org/ports/netbsd/">change 
                 kernels</a>.)
                 </li><li>System doesn't give software excessive privilege or 
                 easy paths to escalation.  Components run with high 
                 privilege are kept as small and carefully checked as 
                 possible.  Interacting components seldom even run as the 
                 <em>same</em> effective user ID, and thus are in a poor
                 position to subvert one another's resources.
                 </li><li>As a result of the above, system state is highly 
                 transparent, lending itself to effective scrutiny and 
                 management via simple, well-understood tools (including 
                 ps, netstat, lsof, lslk, fuser, etc.).
             </li></ul>

             <p>For details, please see Petreley, Raymond, and Self's 
             more-comprehensive write-ups.</p>

         </li></ul>

  <p>Last modified: 2011-07-06</p>

  <address>
    <a href="mailto:%20rick@linuxmafia.com%20">rick@linuxmafia.com</a>
  </address><br>

  <p>Copyright (C) 1995-2011 by Rick Moen. Verbatim copying,
  distribution, and display of this entire article (page) are permitted in
  any medium, provided this notice is preserved. Alternatively, you
  may create derivative works of any sort for any purpose, provided
  your versions contain no attribution to me, and that you assert
  your own authorship (and not mine) in every practical medium.</p>
  <hr>

  <p><a href="#TOP">Top of page</a></p>
</div>


</body></html>